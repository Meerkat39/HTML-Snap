# E2E テストと Playwright の基礎

## 📅 学習日時

2025 年 9 月 7 日

## ✅ 結論

- **E2E（End-to-End）テスト**は「ユーザー操作を自動化し、アプリ全体の動作を本番に近い形で検証するテスト」
- **Playwright**は、E2E テストを自動化するための強力な OSS ツール。主要ブラウザ（Chromium/Firefox/WebKit）を自動操作できる
- UI の一連のフロー（例：ボタン押下 → 画面遷移 → 通知表示など）を本物のブラウザ上で再現・検証できる

## 🧠 詳細

### E2E テストとは

- 「End-to-End（端から端まで）」の名の通り、**実際のユーザー操作を自動化し、アプリ全体の流れを検証するテスト**
- 単体テスト（関数単位）や結合テスト（複数コンポーネントの連携）よりも、さらに広い範囲をカバー
- 例：
  - ユーザーがフォームに入力 → 送信 → 確認画面 → 完了通知、までの一連の流れを自動でテスト
  - ボタンをクリック →API 通信 → 画面更新 → 通知表示、など
- **本番に近い環境・ブラウザで動作確認できる**のが最大の特徴
- 欠点：テスト実行がやや遅い、セットアップがやや複雑、テストの安定性に注意が必要

### Playwright とは

- Microsoft 製の E2E テスト自動化フレームワーク（OSS）
- 特徴：
  - Chromium（Chrome 系）、Firefox、WebKit（Safari 系）を同じ API で操作可能
  - ユーザー操作（クリック、入力、ドラッグ、スクロール等）を本物のブラウザで自動化
  - スクリーンショット・動画撮影・ネットワークモック・認証・マルチタブ操作など高機能
  - CI/CD（GitHub Actions 等）との連携も容易
- 代表的なコマンド例：
  - `npx playwright test` … E2E テスト一括実行
  - `npx playwright codegen http://localhost:3000/` … GUI で操作しながらテストコード自動生成
  - `npx playwright show-report` … テスト結果の HTML レポート表示

### Playwright でできること（例）

- サインイン → ダッシュボード遷移 → データ登録 → 通知表示 → サインアウトまで一連の流れを自動検証
- 画面の見た目（スナップショット）比較
- API レスポンスのモックやネットワーク遅延の再現
- 複数ブラウザ・複数デバイス（スマホ/PC）での動作確認

### E2E テストの位置づけ

- 単体テスト（Jest 等）…ロジック・関数単位の検証
- 結合テスト（React Testing Library 等）…複数 UI/ロジックの連携検証
- **E2E テスト（Playwright 等）…ユーザー視点でのアプリ全体の流れ・本番同等の動作検証**

### 参考

- Playwright 公式: https://playwright.dev/
- HTML Snap プロジェクトでの E2E テスト例: `e2e/` ディレクトリ配下にテストコードを追加
